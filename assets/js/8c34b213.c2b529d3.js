"use strict";(self.webpackChunksilogen_docs=self.webpackChunksilogen_docs||[]).push([[493],{7886:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>a,contentTitle:()=>l,default:()=>d,frontMatter:()=>r,metadata:()=>i,toc:()=>c});var o=t(4848),s=t(8453);const r={sidebar_position:2},l="Python Example",i={id:"using-the-api/llm-service/python-example",title:"Python Example",description:"You need to install the following packages to run the code:",source:"@site/docs/using-the-api/llm-service/python-example.md",sourceDirName:"using-the-api/llm-service",slug:"/using-the-api/llm-service/python-example",permalink:"/docs/using-the-api/llm-service/python-example",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:2,frontMatter:{sidebar_position:2},sidebar:"docsSidebar",previous:{title:"Common Parameters and Values",permalink:"/docs/using-the-api/llm-service/common-parameters"},next:{title:"Changing Prompt Template for RAG",permalink:"/docs/using-the-api/llm-service/changing-prompt-template"}},a={},c=[];function p(e){const n={code:"code",h1:"h1",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.header,{children:(0,o.jsx)(n.h1,{id:"python-example",children:"Python Example"})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-python",children:'import os\n\nfrom keycloak import KeycloakOpenID\nfrom openai import OpenAI\n\n\nclass KeycloakAuth:\n    def __init__(self, server_url, client_id, realm_name):\n        self.keycloak_openid = KeycloakOpenID(server_url=server_url, client_id=client_id, realm_name=realm_name)\n\n    def token(self, username, password):\n        response = self.keycloak_openid.token(username=username, password=password)  # type: ignore\n        return response["access_token"]\n\nTOKEN = KeycloakAuth(\n    server_url="https://auth.services.silogen.ai",\n    client_id="cc6e3d5f-0b70-462c-b40a-1d795c948d3d",\n    realm_name="silogen",\n).token(\n    username=os.environ.get("KEYCLOAK_USERNAME"),\n    password=os.environ.get("KEYCLOAK_PASSWORD"),\n)\nOPENAI_BASE_URL = "https://model-service.services.silogen.ai/v1"\n\nclient = OpenAI(base_url=OPENAI_BASE_URL, api_key=TOKEN)\n\n# List all available models in model catalogue within your account\nmodels_list = client.models.list()\n\n# Get a model from model catalogue (first model in catalogue is indexed as 0)\nmodel_id = client.models.list().data[0].id\n\nhistory_openai_format = [\n    {"role": "system", "content": "You are a helpful assistant!"},\n    {"role": "user", "content": "Hello World!"},\n]\ncompletion = client.chat.completions.create(\n    model=model_id,\n    messages=history_openai_format,\n    temperature=0.0,\n    stream=True,\n)\n\nfor chunk in completion:\n    content = chunk.choices[0].delta.content\n    if content:\n        print(content, end="")\n'})}),"\n",(0,o.jsx)(n.p,{children:"You need to install the following packages to run the code:"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:(0,o.jsx)(n.code,{children:"requests"})}),"\n",(0,o.jsx)(n.li,{children:(0,o.jsx)(n.code,{children:"python-keycloak"})}),"\n",(0,o.jsx)(n.li,{children:(0,o.jsx)(n.code,{children:"openai"})}),"\n"]}),"\n",(0,o.jsxs)(n.p,{children:["Example: ",(0,o.jsx)(n.code,{children:"pip install requests python-keycloak openai"})]}),"\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.strong,{children:"Example of using extra RAG parameters in the request"}),":"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-python",children:'completion = client.chat.completions.create(\n    model=model_id,\n    messages=history_openai_format,\n    temperature=0.0,\n    stream=STREAM,\n    extra_headers=AUTHORIZATION_HEADER,\n    extra_body={\n        "debug": True,\n        "collection": {\n            "collectionId": collection_id,\n            "top_k": 4,\n            "alpha": 0.5,\n            "hybrid_search": True\n        },\n        "prompt_template":prompt_template\n    },\n)\n'})})]})}function d(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(p,{...e})}):p(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>l,x:()=>i});var o=t(6540);const s={},r=o.createContext(s);function l(e){const n=o.useContext(r);return o.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:l(e.components),o.createElement(r.Provider,{value:n},e.children)}}}]);